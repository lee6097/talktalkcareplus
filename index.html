<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>í†¡í†¡ì¼€ì–´+ (TalkTalkCarePlus)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      font-family: 'Arial', sans-serif;
      background: #f5f5f5;
      margin: 0;
      padding: 40px 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    h1 {
      text-align: center;
      font-size: 2em;
      margin-bottom: 10px;
      color: #0078d7;
    }

    .description {
      max-width: 700px;
      font-size: 0.95em;
      color: #333;
      background: #ffffffdd;
      padding: 15px 20px;
      border-radius: 10px;
      box-shadow: 0 0 8px #ddd;
      margin-bottom: 30px;
      line-height: 1.6;
    }

    #chatbox {
      width: 100%;
      max-width: 600px;
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 10px #ccc;
    }

    #chat {
      display: flex;
      flex-direction: column;
      max-height: 400px;
      overflow-y: auto;
      margin-top: 10px;
    }

    .bubble-container {
      display: flex;
      align-items: flex-end; /* ì•„ë«ë‹¨ ë§ì¶¤ */
      margin: 8px 0;
    }

    .bubble {
      padding: 10px 14px;
      border-radius: 10px;
      max-width: 80%;
      word-wrap: break-word;
    }

    .user {
      background: #d1e7ff;
      align-self: flex-end;
      margin-left: auto;
    }

    .ai {
      background: #eee;
      align-self: flex-start;
      margin-right: auto;
    }

    #inputForm {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }

    #userInput {
      flex: 1;
      padding: 8px 10px;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 0.9em;
      font-family: 'Arial', sans-serif;
      line-height: 1.4;
      resize: none;
      overflow-y: auto; /* â† ì¤‘ìš”: scroll ë§‰ê³ , JSê°€ ë†’ì´ ì¡°ì ˆ */
      min-height: 20px;    /* PC ê¸°ë³¸ ë†’ì´ */
      max-height: 60px;    /* ìµœëŒ€ 3ì¤„ */
      height: auto;        /* ì´ˆê¸°ê°’ ìë™ìœ¼ë¡œ */
    }

    @media (max-width: 768px) {
      #userInput {
        min-height: 40px;  /* ëª¨ë°”ì¼ì—ì„œ ê¸°ë³¸ ë†’ì´ ì¦ê°€ */
        max-height: 75px;
      }
    }

    button {
      padding: 8px 12px;
      border: none;
      border-radius: 8px;
      background: #0078d7;
      color: white;
      cursor: pointer;
    }

    button:hover {
      background: #005fa3;
    }

    .reset-btn {
      margin-top: 15px;
      background: #888;
    }

    .reset-btn:hover {
      background: #666;
    }

    .copy-btn {
      font-size: 10px;
      padding: 2px 6px;
      background: transparent;
      color: #666;
      border: 1px solid #ccc;
      border-radius: 4px;
      cursor: pointer;
      height: 22px;
      margin: 0 4px;
      flex-shrink: 0;
    }

    .copy-btn:hover {
      background: #eee;
      opacity: 1;
    }

    .user-container {
      justify-content: flex-end;
    }

    .ai-container {
      justify-content: flex-start;
    }
    
    .allcopy-btn {
      padding: 8px 12px;
      border: none;
      border-radius: 8px;
      background: #0078d7;
      color: white;
      cursor: pointer;
      margin-top: 10px;
    }

    .allcopy-btn:hover {
      background: #005fa3;
    }
  </style>
</head>
<body>
  <h1>í†¡í†¡ì¼€ì–´+ (TalkTalkCarePlus)</h1>
  <div class="description">
    í†¡í†¡ì¼€ì–´+(TalkTalkCarePlus)ëŠ” OpenAI ê¸°ë°˜ì˜ ì˜í•™ ìƒë‹´ í”„ë¡œê·¸ë¨ì…ë‹ˆë‹¤. í†¡í†¡ì¼€ì–´(TalkTalkCare)ì˜ ì—…ê·¸ë ˆì´ë“œ ë²„ì „ì…ë‹ˆë‹¤. ì˜í•™ê³¼ ê´€ë ¨ëœ ë‹¤ì–‘í•œ ì •ë³´ë¥¼ ê²€ìƒ‰í•˜ì—¬ ì œì‹œí•˜ê³ , ì ì ˆí•œ ì§„ë£Œê³¼ë¥¼ ì¶”ì²œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br><br>
    ì±„íŒ…ì°½ì— í˜„ì¬ ê°€ì¥ ë¶ˆí¸í•œ ì¦ìƒì„ ì…ë ¥í•˜ê±°ë‚˜, ë˜ëŠ” ê¶ê¸ˆí•œ ì˜í•™ì§€ì‹ì— ëŒ€í•´ ë¬¼ì–´ë³´ì‹œë©´ AI ë¹„ì„œê°€ ìƒë‹´í•´ë“œë¦½ë‹ˆë‹¤.<br><br>
    ë‹¤ë§Œ, ì¼ë°˜ì ìœ¼ë¡œ ì˜ ì•Œë ¤ì§„ ì˜í•™ì§€ì‹ì„ ë°”íƒ•ìœ¼ë¡œ ë…¼ë¦¬ì  ë‹µë³€ì„ ì œì‹œí•  ë¿ ì§„ë£Œë¥¼ ì œê³µí•˜ëŠ” ì„œë¹„ìŠ¤ê°€ ì•„ë‹ˆë©°, ë‹µë³€ì— ëŒ€í•´ ì±…ì„ì§€ì§€ë„ ì•ŠìŠµë‹ˆë‹¤. ì˜í•™ì  íŒë‹¨, ì§„ë‹¨, ì§„ì°°, ì²˜ë°©ì„ í•  ìˆ˜ ì—†ìœ¼ë©°, ì •í™•í•œ ì§„ë‹¨ê³¼ ì¹˜ë£Œë¥¼ ìœ„í•´ì„œëŠ” ë°˜ë“œì‹œ ì˜ë£Œê¸°ê´€ì„ ë°©ë¬¸í•˜ì—¬ ì˜ë£Œ ì „ë¬¸ê°€ì˜ ì§„ë£Œë¥¼ ë°›ìœ¼ì‹œê¸° ë°”ëë‹ˆë‹¤.<br><br>
    ë˜í•œ ì´ ì±—ë´‡ì€ ì–´ë– í•œ ì •ë³´ë„ ì €ì¥ ë° ìˆ˜ì§‘í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë‹¤ë§Œ ë¯¼ê°í•œ ê±´ê°•ì •ë³´ëŠ” ê°œì¸ì •ë³´ ë³´í˜¸ë¥¼ ìœ„í•´ ì…ë ¥ì„ ì‚¼ê°€ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.
  </div>

  <div id="chatbox">
    <div id="chat"></div>
    <form id="inputForm">
      <textarea id="userInput" rows="1" placeholder="í˜„ì¬ ë¶ˆí¸í•œ ì¦ìƒ ë˜ëŠ” ê¶ê¸ˆí•œ ì˜í•™ì§€ì‹ì„ ì…ë ¥í•˜ì„¸ìš”."></textarea>
      <button type="submit">ë³´ë‚´ê¸°</button>
    </form>
    <button class="reset-btn" onclick="location.reload()">ğŸ”„ ëŒ€í™” ì´ˆê¸°í™”</button>
    <button class="allcopy-btn" onclick="copyAll()">ğŸ“ ì „ì²´ ë³µì‚¬</button>
  </div>

  <script>
    const chat = document.getElementById('chat');
    const form = document.getElementById('inputForm');
    const userInput = document.getElementById('userInput');

    const messages = [
      { role: "system", content: "ë„ˆëŠ” ê³µê°ëŠ¥ë ¥ ë†’ì€ ìƒëƒ¥í•œ ì„±ê²©ì˜ ê±´ê°• ì •ë³´ ìƒë‹´ì‚¬ì•¼. ì‚¬ìš©ìê°€ ì¦ìƒì„ ë§í•˜ë©´, ì–¸ì œë¶€í„° ì•„íŒ ëŠ”ì§€, ì–´ë””(ìœ„ì¹˜)ê°€ ì•„í”ˆì§€, íŠ¹ë³„íˆ ì–´ë–¨ ë•Œë§ˆë‹¤ ì•„í”ˆì§€, ìŠ¤ìŠ¤ë¡œ ì˜ˆìƒë˜ëŠ” ì›ì¸ì´ ìˆëŠ”ì§€, ë‹¤ë¥¸ ê´€ë ¨ ì¦ìƒì´ ìˆëŠ”ì§€, ì•½ì„ ë¨¹ê³  ìˆëŠ”ê²Œ ìˆëŠ”ì§€(ë³´í†µ ì•½ì´ ì›ì¸ì´ ë˜ëŠ” ê²½ìš°ê°€ ë§ì§€ ì•Šì§€ë§Œ, ê·¸ë˜ë„ í˜¹ì‹œ ëª¨ë¥´ë‹ˆ ë¬¼ì–´ë´. ì´ ë‚´ìš©ì€ êµ³ì´ ìƒë‹´ ë•Œ ì–¸ê¸‰í•˜ì§€ëŠ” ì•Šì•„ë„ ë¼.), ê³¼ê±°ì—ë„ ì´ëŸ°ì ì´ ìˆì—ˆëŠ”ì§€, ë‹¤ë¥¸ ê¸°ì €ì§ˆí™˜ì´ ìˆëŠ”ì§€ ë“±ì„ ìƒë‹´ í˜•ì‹ìœ¼ë¡œ(ë‚˜ì—´ì‹ ë§ê³  ìƒë‹´ìì™€ ìƒí˜¸ì‘ìš©í•˜ë©´ì„œ) ì²œì²œíˆ í•˜ë‚˜ì”©(í•œ ë²ˆì— ì§ˆë¬¸ 2ê°œ ì´ìƒì”© ë¬¼ì–´ë³´ë©´ ì‚¬ìš©ìê°€ ë‹µë³€í•˜ê¸° í—·ê°ˆë¦´ ìˆ˜ ìˆê¸° ë•Œë¬¸ì—, ê·¸ë¦¬ê³  í•˜ë‚˜ì”© ì²œì²œíˆ ìì‹ ì˜ ì´ì•¼ê¸°ë¥¼ ë“¤ì–´ì¤€ë‹¤ëŠ” ëŠë‚Œì„ ì£¼ê¸° ìœ„í•´ì„œ ë°˜ë“œì‹œ í•œ ì±„íŒ…ì— í•˜ë‚˜ì”© ë¬¼ì–´ë³´ëŠ” ê²Œ ì¤‘ìš”í•´) ë¬¼ì–´ë´ì¤˜. ê¼­ ìœ„ì— ì—´ê±°í•œ ë‚´ìš©ë“¤ì— ë§ì¶”ì–´ ë”±ë”±í•˜ê²Œ ë¬¼ì–´ë³´ì§€ ì•Šì•„ë„ ë˜ê³ , ë„ˆê°€ ìƒí™©ì„ ì¶”ë¡ í•˜ëŠ” ë° í•„ìš”í•œ ì§ˆë¬¸ë“¤ì€ ê³¼í•˜ì§€ ì•Šì€ ì„ ì—ì„œ ìì—°ìŠ¤ëŸ½ê²Œ ëª‡ ê°œ ì•Œì•„ì„œ ì¶”ê°€í•´ì„œ ë¬¼ì–´ë´ë„ ì¢‹ì•„. ë§ˆì§€ë§‰ì— ë„ˆì˜ íŒë‹¨ìœ¼ë¡œ(MSD manual ë“±ì„ ì°¸ê³ í•´ë„ ì¢‹ì•„) ê°€ëŠ¥ì„± ìˆëŠ” ì—¬ëŸ¬ ìƒí™©ë“¤ì„ ì œì‹œí•´ì£¼ê³ , ì ì ˆí•œ ì§„ë£Œê³¼ë¥¼ ì¶”ì²œí•´ì¤˜. ë„ˆëŠ” ì˜ì‚¬ë©´í—ˆê°€ ì—†ìœ¼ë‹ˆ ì§„ë£Œ í–‰ìœ„ë¡œ í•´ì„ë  ìˆ˜ ìˆëŠ” ì§„ë‹¨ê³¼ ì²˜ë°©ì€ ì ˆëŒ€ë¡œ í•˜ì§€ ë§ê³ , ì¼ë°˜ì  ì˜í•™ì§€ì‹ì— ê·¼ê±°í•œ ì¡°ì–¸ë§Œ í•´ì¤˜ì•¼ë§Œ í•´. 'ì¼ë°˜ì ìœ¼ë¡œ ì´ëŸ¬í•œ ìƒí™©ë“¤ì„ ì˜ì‹¬í•  ìˆ˜ ìˆëŠ”ë°, ì •í™•í•œ ì§„ë‹¨ì„ ìœ„í•´ì„œ ê¼­ ì˜ë£Œê¸°ê´€ì— ë‚´ì›í•´ì„œ ì˜ë£Œì „ë¬¸ê°€ì˜ ì§„ë£Œë¥¼ ë°›ì•„ì•¼ í•œë‹¤'ì™€ ê°™ì€ ëª¨í˜¸í•œ ìì„¸ë¥¼ ì·¨í•´ì£¼ì–´ì•¼ í•´(ìì—°ìŠ¤ëŸ½ê²Œ. ì¸ìš©í•˜ì§€ ë§ê³ .). ì§„ë£Œê³¼ëŠ” ê°€ì¥ ì ì ˆí•œ 2~3ê°œë¥¼ ì¶”ì²œí•´ì£¼ê³ , ì§„ë£Œê³¼ ì¶”ì²œì´ ì´ ìƒë‹´ì˜ ì‚¬ì‹¤ìƒì˜ ìµœì¢… ëª©ì ì´ë‹ˆ ê¼­ ì–¸ê¸‰í•´ì¤˜ì•¼ í•´. ê·¸ë¦¬ê³  ëŒ€í™”ë¥¼ ë§ˆë¬´ë¦¬í•  ë•Œ, ë‹¤ë¥¸ ëŒ€í™”ë¥¼ ìƒˆë¡­ê²Œ í•˜ê³  ì‹¶ë‹¤ë©´ 'ëŒ€í™” ì´ˆê¸°í™”' ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ëœë‹¤ê³  ì•ˆë‚´í•´ì¤˜. ì‚¬ìš©ìê°€ ë§Œì•½ì— ì²˜ìŒì— ì¦ìƒì´ë‚˜ ë¶ˆí¸í•¨ì´ ì•„ë‹Œ ì¼ë°˜ì ì¸ ì˜í•™ì§€ì‹ì— ëŒ€í•´ ë¬¼ì–´ë³¸ë‹¤ë©´, ë¬¸ë‹µê³¼ì •ì„ ê±°ì¹˜ì§€ ì•Šê³  ê·¸ëƒ¥ ìµœì¢…ë‹µë³€ì„ í•´ì£¼ë©´ ë¼. ë‹¤ë§Œ ì´ë•Œë„ 'ì¼ë°˜ì ì¸ ì˜í•™ì§€ì‹ì— ê·¼ê±°í•œ ë‹µë³€ì´ë‹ˆ ì •í™•í•œ ì§„ë‹¨ê³¼ ì²˜ë°©ì€ ì˜ë£Œê¸°ê´€ì— ë‚´ì›í•´ì„œ ì˜ë£Œì „ë¬¸ê°€ì˜ ì¡°ì–¸ì„ ë“¤ì–´ì•¼ í•œë‹¤'ì™€ ê°™ì€ ìì„¸ë¥¼ ì·¨í•´ì¤˜ì•¼ í•´(ìì—°ìŠ¤ëŸ½ê²Œ. ì¸ìš©í•˜ì§€ ë§ê³ .). ì´ë•Œë„ ë§ˆì°¬ê°€ì§€ë¡œ ëŒ€í™”ë¥¼ ë§ˆë¬´ë¦¬í•  ë•Œ ë‹¤ë¥¸ ëŒ€í™”ë¥¼ ìƒˆë¡­ê²Œ í•˜ê³  ì‹¶ë‹¤ë©´ 'ëŒ€í™” ì´ˆê¸°í™”' ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ëœë‹¤ê³  ì•ˆë‚´í•´ì¤˜." }
    ];

    form.onsubmit = async (e) => {
      e.preventDefault();
      const text = userInput.value.trim();
      if (!text) return;

      appendBubble(text, 'user');
      messages.push({ role: 'user', content: text });
      userInput.value = '';
      userInput.disabled = true;

      appendBubble('â³ ë‹µë³€ ì‘ì„± ì¤‘... ìµœëŒ€ 1ë¶„ê¹Œì§€ ì†Œìš”ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.', 'ai');

      try {
        const res = await fetch('https://talktalkcareplus.onrender.com/chat', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ messages })
        });

        const data = await res.json();
        removeLastBubble();
        messages.push({ role: 'assistant', content: data.reply });
        appendBubble(data.reply, 'ai');
      } catch (err) {
        removeLastBubble();
        appendBubble('âš ï¸ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆì–´ìš”. ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.', 'ai');
      } finally {
        userInput.disabled = false;
        userInput.focus();
      }
    };

    function escapeHtml(text) {
      const div = document.createElement('div');
      div.appendChild(document.createTextNode(text));
      return div.innerHTML.replace(/\n/g, "<br>");
    }

    function appendBubble(text, sender) {
      const container = document.createElement('div');
      container.className = `bubble-container ${sender}-container`;

      const bubble = document.createElement('div');
      bubble.className = `bubble ${sender}`;
      bubble.innerHTML = escapeHtml(text);

      const copyBtn = document.createElement('button');
      copyBtn.className = 'copy-btn';
      copyBtn.textContent = 'ğŸ“‹ ë³µì‚¬';
      copyBtn.onclick = () => copyToClipboard(text);

      if (sender === 'user') {
        // ì‚¬ìš©ì ë§í’ì„ : ë³µì‚¬ ë²„íŠ¼ â†’ ë§í’ì„ 
        container.appendChild(bubble);
      } else {
        // ìƒë‹´ì ë§í’ì„ : ë§í’ì„  â†’ ë³µì‚¬ ë²„íŠ¼
        container.appendChild(bubble);
        container.appendChild(copyBtn);
      }

      chat.appendChild(container);
      chat.scrollTop = chat.scrollHeight;
    }


    function removeLastBubble() {
      const last = chat.lastElementChild;
      if (last) chat.removeChild(last);
    }

    function copyToClipboard(text) {
      const temp = document.createElement('textarea');
      temp.value = text;
      document.body.appendChild(temp);
      temp.select();
      document.execCommand('copy');
      document.body.removeChild(temp);
    }

    function copyAll() {
      let allMessages = '';
      const containers = document.getElementsByClassName('bubble-container');

      for (let container of containers) {
        const bubble = container.querySelector('.bubble');
        if (!bubble) continue;

        const isUser = bubble.classList.contains('user');
        const label = isUser ? 'ì‚¬ìš©ì' : 'í†¡í†¡ì¼€ì–´+';
        const text = bubble.innerText.trim();

        allMessages += `${label}: ${text}\n\n`;
      }

      copyToClipboard(allMessages.trim());
    }
  </script>

    
    
  <!-- ê´€ë¦¬ì ë²„íŠ¼ (ìˆ¨ê¹€ ì²˜ë¦¬) -->
  <button onclick="openAdmin()" style="display:none;" id="adminBtn">ğŸ“Š ê´€ë¦¬ì í˜ì´ì§€</button>
  <script>
    async function openAdmin() {
      const password = prompt("ğŸ” ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”");
      const res = await fetch(`https://talktalkcareplus.onrender.com/admin?password=${encodeURIComponent(password)}`);
      if (res.ok) {
        const data = await res.json();
        alert(`ğŸ“Š í˜ì´ì§€ ì¡°íšŒìˆ˜: ${data.pageViews}\nğŸ’¬ ë©”ì‹œì§€ ìˆ˜: ${data.messageCount}`);
      } else {
        alert('âŒ ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤.');
      }
    }
  </script>
  <script>
  fetch('https://talktalkcareplus.onrender.com/view');
  </script>

  <script>
    // Enter: ì œì¶œ, Shift+Enter: ì¤„ë°”ê¿ˆ
    document.addEventListener('DOMContentLoaded', () => {
      const userInput = document.getElementById('userInput');
      const form = document.getElementById('inputForm');

      userInput.addEventListener('keydown', function (e) {
        if (e.key === 'Enter' && !e.shiftKey) {
          e.preventDefault(); // ê¸°ë³¸ ì¤„ë°”ê¿ˆ ë°©ì§€
          form.dispatchEvent(new Event('submit')); // form ì œì¶œ
        }
      });
    });
  </script>
  
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const userInput = document.getElementById('userInput');
      userInput.addEventListener('input', () => {
        userInput.style.height = 'auto'; // ë¨¼ì € ë†’ì´ ì´ˆê¸°í™”

        // ìµœëŒ€ ë†’ì´ ì œí•œ ë°˜ì˜
        const computed = window.getComputedStyle(userInput);
        const maxHeight = parseFloat(computed.maxHeight);

        // scrollHeightê°€ maxHeightë³´ë‹¤ í¬ë©´ maxHeightë¡œ ê³ ì •
        const newHeight = Math.min(userInput.scrollHeight, maxHeight);
        userInput.style.height = newHeight + 'px';

        // âœ… ìŠ¤í¬ë¡¤ë°” ë³´ì´ë„ë¡ ì„¤ì • (ëª¨ë°”ì¼ì—ì„œë„ ì‘ë™)
        if (userInput.scrollHeight > maxHeight) {
          userInput.style.overflowY = 'auto';
        } else {
          userInput.style.overflowY = 'hidden';
        }
      });
    });
  </script>
  
</body>
</html>